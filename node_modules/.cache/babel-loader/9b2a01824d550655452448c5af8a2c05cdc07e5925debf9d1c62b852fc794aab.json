{"ast":null,"code":"import _toConsumableArray from\"/home/drevil/react/drum-machine-2/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/drevil/react/drum-machine-2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import Display from'./components/display';import Drumpad from'./components/drumpad';import Controls from'./components/controls';import'./App.css';// font imports\nimport\"./fonts/Ledsim-JRz7o.ttf\";// web audio\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var audioCtx=new AudioContext();var destination=audioCtx.createMediaStreamDestination();var recorder=new MediaRecorder(destination.stream);var gainNode=audioCtx.createGain();function App(){var drumObj={drums:[{pad:1,id:\"Q\",keycode:81,label:\"High Tom\",src:\"/audio/hitom.wav\"},{pad:2,id:\"W\",keycode:87,label:\"Mid Tom\",src:\"/audio/midtom2.wav\"},{pad:3,id:\"E\",keycode:69,label:\"Low Tom\",src:\"/audio/loetom.wav\"},{pad:4,id:\"A\",keycode:65,label:\"Kick\",src:\"/audio/808bd2.wav\"},{pad:5,id:\"S\",keycode:83,label:\"Open High Hat\",src:\"/audio/707-ohh.wav\"},{pad:6,id:\"D\",keycode:68,label:\"Foot High Hat\",src:\"/audio/big-foot-hh.wav\"},{pad:7,id:\"Z\",keycode:90,label:\"Snare\",src:\"/audio/brass-sd2.wav\"},{pad:8,id:\"X\",keycode:88,label:\"Bright Open High Hat\",src:\"/audio/909-bright-ohh.wav\"},{pad:9,id:\"C\",keycode:67,label:\"Collapsed Hat\",src:\"/audio/909-collapsed-hat.wav\"}]};var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),display=_useState2[0],setDisplay=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),volume=_useState4[0],setVolume=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),recording=_useState6[0],setRecording=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),records=_useState8[0],setRecords=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),track=_useState10[0],setTrack=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),trackPlaying=_useState12[0],setTrackPlaying=_useState12[1];var handleVolumeControl=function handleVolumeControl(e){setVolume(e.target.value);gainNode.gain.value=e.target.value;};var handlePause=function handlePause(e){if(trackPlaying){e.onended=function(){setTrackPlaying(!trackPlaying);};//let sound = e;\ne.pause();}else if(e.currentTime!==0){e.play();}else{handlePlaySound(e);}setTrackPlaying(!trackPlaying);};var handlePlaySound=function handlePlaySound(e){var sound=e;console.log(sound);audioCtx.resume();sound.currentTime=0;sound.play();var source=audioCtx.createMediaElementSource(sound);source.connect(gainNode);gainNode.connect(audioCtx.destination);gainNode.connect(destination);};var handleRecorder=function handleRecorder(e){if(!recording){var chunks=[];recorder.start();recorder.ondataavailable=function(e){return chunks.push(e.data);};recorder.onstop=function(e){var blob=new Blob(chunks,{'type':'audio/wav; codecs=wave'});var url=URL.createObjectURL(blob);var a;a=new Audio();a.src=url;a.controls=true;a.download='a.wav';a.preload='auto';document.getElementById('records').appendChild(a);setRecords([].concat(_toConsumableArray(records),[a]));if(track===0)setTrack(1);};}else{recorder.stop();}setRecording(!recording);};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"App-header\",children:\"React Drum Machine\"}),/*#__PURE__*/_jsxs(\"div\",{id:\"drum-machine\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"drumpad-container\",children:drumObj.drums.map(function(drum){return/*#__PURE__*/_jsx(Drumpad,{drum:drum,drumObj:drumObj,handlePlaySound:handlePlaySound,displayHandler:setDisplay,volume:volume},drum.id);})}),/*#__PURE__*/_jsxs(\"div\",{id:\"display-control-container\",children:[/*#__PURE__*/_jsx(Display,{value:display,volume:volume,rec:recording,records:records,track:track}),/*#__PURE__*/_jsx(Controls,{value:display,volume:volume,rec:recording,records:records,setRecords:setRecords,track:track,trackPlaying:trackPlaying,setTrackPlaying:setTrackPlaying,setTrack:setTrack,play:handlePause,handleRecorder:handleRecorder,handleChange:handleVolumeControl})]})]})]});}export default App;","map":{"version":3,"names":["React","useState","Display","Drumpad","Controls","audioCtx","AudioContext","destination","createMediaStreamDestination","recorder","MediaRecorder","stream","gainNode","createGain","App","drumObj","drums","pad","id","keycode","label","src","display","setDisplay","volume","setVolume","recording","setRecording","records","setRecords","track","setTrack","trackPlaying","setTrackPlaying","handleVolumeControl","e","target","value","gain","handlePause","onended","pause","currentTime","play","handlePlaySound","sound","console","log","resume","source","createMediaElementSource","connect","handleRecorder","chunks","start","ondataavailable","push","data","onstop","blob","Blob","url","URL","createObjectURL","a","Audio","controls","download","preload","document","getElementById","appendChild","stop","map","drum"],"sources":["/home/drevil/react/drum-machine-2/src/App.js"],"sourcesContent":["import React, { useState } from 'react';\nimport Display from './components/display';\nimport Drumpad from './components/drumpad';\nimport Controls from './components/controls';\nimport './App.css';\n\n// font imports\n\nimport \"./fonts/Ledsim-JRz7o.ttf\";\n\n// web audio\n\nconst audioCtx = new AudioContext();\nconst destination = audioCtx.createMediaStreamDestination();\nconst recorder = new MediaRecorder(destination.stream);\nconst gainNode = audioCtx.createGain();\n\n\nfunction App() {\n\n  \n\n\n  const drumObj = {\n       \n    drums: [{\n        pad: 1,\n        id: \"Q\",\n        keycode: 81,\n        label: \"High Tom\",\n        src: \"/audio/hitom.wav\"\n      },\n      {\n        pad: 2,\n        id: \"W\",\n        keycode: 87,\n        label: \"Mid Tom\",\n        src: \"/audio/midtom2.wav\"\n      },\n      {\n        pad: 3,\n        id: \"E\",\n        keycode: 69,\n        label: \"Low Tom\",\n        src: \"/audio/loetom.wav\"\n      },\n      {\n        pad: 4,\n        id: \"A\",\n        keycode: 65,\n        label: \"Kick\",\n        src: \"/audio/808bd2.wav\"\n      },\n      {\n        pad: 5,\n        id: \"S\",\n        keycode: 83,\n        label: \"Open High Hat\",\n        src: \"/audio/707-ohh.wav\"\n      },\n      {\n        pad: 6,\n        id: \"D\",\n        keycode: 68,\n        label: \"Foot High Hat\",\n        src: \"/audio/big-foot-hh.wav\"\n      },\n      {\n        pad: 7,\n        id: \"Z\",\n        keycode: 90,\n        label: \"Snare\",\n        src: \"/audio/brass-sd2.wav\"\n      },\n      {\n        pad: 8,\n        id: \"X\",\n        keycode: 88,\n        label: \"Bright Open High Hat\",\n        src: \"/audio/909-bright-ohh.wav\"\n      },\n      {\n        pad: 9,\n        id: \"C\",\n        keycode: 67,\n        label: \"Collapsed Hat\",\n        src: \"/audio/909-collapsed-hat.wav\"\n      }\n\n    ]};  \n    \n   \n  const [display, setDisplay] = useState(\"\");\n  const [volume, setVolume] = useState(1);\n  const [recording, setRecording] = useState(false);\n  const [records, setRecords] = useState([]);\n  const [track, setTrack] = useState(0);\n  const [trackPlaying, setTrackPlaying] = useState(false);\n\n  const handleVolumeControl = (e) => {\n    setVolume(e.target.value);\n    gainNode.gain.value = e.target.value;\n  };\n\n  const handlePause = (e) => {\n    \n    if(trackPlaying){\n      e.onended = () => {\n        setTrackPlaying(!trackPlaying);\n      }\n      //let sound = e;\n      e.pause();\n    }else if (e.currentTime !== 0){\n      e.play();\n    \n    }else{\n      handlePlaySound(e);\n    }\n    setTrackPlaying(!trackPlaying);\n    \n    }\n  \n\n  const handlePlaySound = (e) => {\n    \n    let sound = e;\n    console.log(sound);\n    audioCtx.resume();\n    sound.currentTime = 0;\n    sound.play();\n    let source = audioCtx.createMediaElementSource(sound);\n    source.connect(gainNode);\n    gainNode.connect(audioCtx.destination);\n    gainNode.connect(destination);\n  };\n\n  const handleRecorder = (e) => {\n    if (!recording) {\n      let chunks = [];\n      recorder.start();\n      recorder.ondataavailable = (e) => chunks.push(e.data);\n      recorder.onstop = (e) => {\n        const blob = new Blob(chunks, {'type': 'audio/wav; codecs=wave'});\n        const url = URL.createObjectURL(blob);\n        let a;\n        a = new Audio()\n        a.src = url;\n        a.controls = true;\n        a.download = 'a.wav';\n        a.preload = 'auto';\n        document.getElementById('records').appendChild(a);\n        setRecords([...records, a]);\n        if (track === 0) setTrack(1);\n      }\n\n    }else{\n      recorder.stop(); \n    }\n    setRecording(!recording);\n    \n  };\n\n\n  return (\n    <div className=\"App\">\n      <div className=\"App-header\">React Drum Machine</div>\n      <div id=\"drum-machine\">\n        <div id=\"drumpad-container\">\n          {drumObj.drums.map((drum) => <Drumpad key={drum.id} drum={drum} drumObj={drumObj} handlePlaySound={handlePlaySound} displayHandler={setDisplay} volume={volume}/>)}\n        </div>\n        <div id=\"display-control-container\">\n          <Display \n            value={display} \n            volume={volume} \n            rec={recording} \n            records={records} \n            track={track} />\n          <Controls \n            value={display} \n            volume={volume} \n            rec={recording} \n            records={records}\n            setRecords={setRecords} \n            track={track}\n            trackPlaying={trackPlaying}\n            setTrackPlaying={setTrackPlaying} \n            setTrack={setTrack}\n\n            play={handlePause} \n            handleRecorder={handleRecorder} \n            handleChange={handleVolumeControl}/>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}