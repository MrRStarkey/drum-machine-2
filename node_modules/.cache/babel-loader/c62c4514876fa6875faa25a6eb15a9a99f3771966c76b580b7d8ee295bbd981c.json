{"ast":null,"code":"import _toConsumableArray from\"/home/drevil/react/drum-machine-2/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _slicedToArray from\"/home/drevil/react/drum-machine-2/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useState}from'react';import Display from'./components/display';import Drumpad from'./components/drumpad';import Controls from'./components/controls';import'./App.css';// font imports\nimport\"./fonts/Ledsim-JRz7o.ttf\";// web audio\nimport{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var options={mimeType:\"audio/webm\"};var audioCtx=new AudioContext();var destination=audioCtx.createMediaStreamDestination();var recorder=new MediaRecorder(destination.stream,options);var gainNode=audioCtx.createGain();console.log(recorder.mimeType);function App(){var drumObj={drums:[{pad:1,id:\"Q\",keycode:81,label:\"High Tom\",src:process.env.PUBLIC_URL+\"/audio/hitom.wav\"},{pad:2,id:\"W\",keycode:87,label:\"Mid Tom\",src:process.env.PUBLIC_URL+\"/audio/midtom2.wav\"},{pad:3,id:\"E\",keycode:69,label:\"Low Tom\",src:process.env.PUBLIC_URL+\"/audio/loetom.wav\"},{pad:4,id:\"A\",keycode:65,label:\"Kick\",src:process.env.PUBLIC_URL+\"/audio/808bd2.wav\"},{pad:5,id:\"S\",keycode:83,label:\"Open High Hat\",src:process.env.PUBLIC_URL+\"/audio/707-ohh.wav\"},{pad:6,id:\"D\",keycode:68,label:\"Foot High Hat\",src:process.env.PUBLIC_URL+\"/audio/big-foot-hh.wav\"},{pad:7,id:\"Z\",keycode:90,label:\"Snare\",src:process.env.PUBLIC_URL+\"/audio/brass-sd2.wav\"},{pad:8,id:\"X\",keycode:88,label:\"Bright Open High Hat\",src:process.env.PUBLIC_URL+\"/audio/909-bright-ohh.wav\"},{pad:9,id:\"C\",keycode:67,label:\"Collapsed Hat\",src:process.env.PUBLIC_URL+\"/audio/909-collapsed-hat.wav\"}]};var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),display=_useState2[0],setDisplay=_useState2[1];var _useState3=useState(1),_useState4=_slicedToArray(_useState3,2),volume=_useState4[0],setVolume=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),recording=_useState6[0],setRecording=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),records=_useState8[0],setRecords=_useState8[1];var _useState9=useState(0),_useState10=_slicedToArray(_useState9,2),track=_useState10[0],setTrack=_useState10[1];var _useState11=useState(false),_useState12=_slicedToArray(_useState11,2),trackPlaying=_useState12[0],setTrackPlaying=_useState12[1];var handleVolumeControl=function handleVolumeControl(e){setVolume(e.target.value);gainNode.gain.value=e.target.value;};var handlePause=function handlePause(e){if(e){setTrackPlaying(!trackPlaying);console.log(\"\".concat(e,\"exists\"));if(trackPlaying){console.log(\"pause\");e.pause();}else if(e.currentTime!==0){console.log(\"play\");e.play();}else{handlePlaySound(e);}e.onended=function(){setTrackPlaying(false);console.log(\"track is done playing\");};}else{return;}};var handlePlaySound=function handlePlaySound(e){var sound=e;console.log(sound);audioCtx.resume();sound.currentTime=0;sound.play();var source=audioCtx.createMediaElementSource(sound);source.connect(gainNode);gainNode.connect(audioCtx.destination);gainNode.connect(destination);};var handleRecorder=function handleRecorder(e){if(!recording){var chunks=[];recorder.start();recorder.ondataavailable=function(e){return chunks.push(e.data);};recorder.onstop=function(e){console.log(recorder.mimeType);var blob=new Blob(chunks,{type:\"audio/webm\"});var url=URL.createObjectURL(blob);var a;a=new Audio();a.src=url;a.controls=true;a.download='a.mp3';a.preload='auto';document.getElementById('records').appendChild(a);setRecords([].concat(_toConsumableArray(records),[a]));if(track===0)setTrack(1);};}else{recorder.stop();}setRecording(!recording);};return/*#__PURE__*/_jsxs(\"div\",{className:\"App\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"App-header\",children:\"React Drum Machine\"}),/*#__PURE__*/_jsxs(\"div\",{id:\"drum-machine\",children:[/*#__PURE__*/_jsx(\"div\",{id:\"drumpad-container\",children:drumObj.drums.map(function(drum){return/*#__PURE__*/_jsx(Drumpad,{drum:drum,drumObj:drumObj,handlePlaySound:handlePlaySound,displayHandler:setDisplay,volume:volume},drum.id);})}),/*#__PURE__*/_jsxs(\"div\",{id:\"display-control-container\",children:[/*#__PURE__*/_jsx(Display,{value:display,volume:volume,rec:recording,records:records,track:track}),/*#__PURE__*/_jsx(Controls,{value:display,volume:volume,rec:recording,records:records,setRecords:setRecords,track:track,trackPlaying:trackPlaying,setTrackPlaying:setTrackPlaying,setTrack:setTrack,play:handlePause,handleRecorder:handleRecorder,handleChange:handleVolumeControl})]})]})]});}export default App;","map":{"version":3,"names":["React","useState","Display","Drumpad","Controls","options","mimeType","audioCtx","AudioContext","destination","createMediaStreamDestination","recorder","MediaRecorder","stream","gainNode","createGain","console","log","App","drumObj","drums","pad","id","keycode","label","src","process","env","PUBLIC_URL","display","setDisplay","volume","setVolume","recording","setRecording","records","setRecords","track","setTrack","trackPlaying","setTrackPlaying","handleVolumeControl","e","target","value","gain","handlePause","pause","currentTime","play","handlePlaySound","onended","sound","resume","source","createMediaElementSource","connect","handleRecorder","chunks","start","ondataavailable","push","data","onstop","blob","Blob","type","url","URL","createObjectURL","a","Audio","controls","download","preload","document","getElementById","appendChild","stop","map","drum"],"sources":["/home/drevil/react/drum-machine-2/src/App.js"],"sourcesContent":["import React, { useState } from 'react';\nimport Display from './components/display';\nimport Drumpad from './components/drumpad';\nimport Controls from './components/controls';\nimport './App.css';\n\n// font imports\n\nimport \"./fonts/Ledsim-JRz7o.ttf\";\n\n// web audio\n\nconst options = {mimeType: \"audio/webm\"};\nconst audioCtx = new AudioContext();\nconst destination = audioCtx.createMediaStreamDestination();\nconst recorder = new MediaRecorder(destination.stream, options);\nconst gainNode = audioCtx.createGain();\nconsole.log(recorder.mimeType);\n\nfunction App() {\n\n  const drumObj = {\n       \n    drums: [{\n        pad: 1,\n        id: \"Q\",\n        keycode: 81,\n        label: \"High Tom\",\n        src: process.env.PUBLIC_URL + \"/audio/hitom.wav\"\n      },\n      {\n        pad: 2,\n        id: \"W\",\n        keycode: 87,\n        label: \"Mid Tom\",\n        src: process.env.PUBLIC_URL + \"/audio/midtom2.wav\"\n      },\n      {\n        pad: 3,\n        id: \"E\",\n        keycode: 69,\n        label: \"Low Tom\",\n        src: process.env.PUBLIC_URL + \"/audio/loetom.wav\"\n      },\n      {\n        pad: 4,\n        id: \"A\",\n        keycode: 65,\n        label: \"Kick\",\n        src: process.env.PUBLIC_URL + \"/audio/808bd2.wav\"\n      },\n      {\n        pad: 5,\n        id: \"S\",\n        keycode: 83,\n        label: \"Open High Hat\",\n        src: process.env.PUBLIC_URL + \"/audio/707-ohh.wav\"\n      },\n      {\n        pad: 6,\n        id: \"D\",\n        keycode: 68,\n        label: \"Foot High Hat\",\n        src: process.env.PUBLIC_URL + \"/audio/big-foot-hh.wav\"\n      },\n      {\n        pad: 7,\n        id: \"Z\",\n        keycode: 90,\n        label: \"Snare\",\n        src: process.env.PUBLIC_URL + \"/audio/brass-sd2.wav\"\n      },\n      {\n        pad: 8,\n        id: \"X\",\n        keycode: 88,\n        label: \"Bright Open High Hat\",\n        src: process.env.PUBLIC_URL + \"/audio/909-bright-ohh.wav\"\n      },\n      {\n        pad: 9,\n        id: \"C\",\n        keycode: 67,\n        label: \"Collapsed Hat\",\n        src: process.env.PUBLIC_URL + \"/audio/909-collapsed-hat.wav\"\n      }\n\n    ]};  \n    \n   \n  const [display, setDisplay] = useState(\"\");\n  const [volume, setVolume] = useState(1);\n  const [recording, setRecording] = useState(false);\n  const [records, setRecords] = useState([]);\n  const [track, setTrack] = useState(0);\n  const [trackPlaying, setTrackPlaying] = useState(false);\n\n  const handleVolumeControl = (e) => {\n    setVolume(e.target.value);\n    gainNode.gain.value = e.target.value;\n  };\n\n  const handlePause = (e) => {\n    \n    if (e){\n      setTrackPlaying(!trackPlaying);\n      console.log(`${e}exists`);\n      if(trackPlaying){\n\n        console.log(\"pause\");\n        e.pause();\n      }else if (e.currentTime !== 0){\n        console.log(\"play\");\n        e.play();\n      \n      }else{\n        handlePlaySound(e);\n      }\n\n      e.onended = () => {\n        setTrackPlaying(false);\n        console.log(\"track is done playing\")\n\n      }\n      \n    } else {\n      return\n    }\n  }\n  \n\n  const handlePlaySound = (e) => {\n    \n    let sound = e;\n    console.log(sound);\n    audioCtx.resume();\n    sound.currentTime = 0;\n    sound.play();\n    let source = audioCtx.createMediaElementSource(sound);\n    source.connect(gainNode);\n    gainNode.connect(audioCtx.destination);\n    gainNode.connect(destination);\n  };\n\n  const handleRecorder = (e) => {\n    if (!recording) {\n      let chunks = [];\n      recorder.start();\n      recorder.ondataavailable = (e) => chunks.push(e.data);\n      recorder.onstop = (e) => {\n        console.log(recorder.mimeType);\n        const blob = new Blob(chunks, {type: \"audio/webm\"});\n        const url = URL.createObjectURL(blob);\n        let a;\n        a = new Audio()\n        a.src = url;\n        a.controls = true;\n        a.download = 'a.mp3';\n        a.preload = 'auto';\n        document.getElementById('records').appendChild(a);\n        setRecords([...records, a]);\n        if (track === 0) setTrack(1);\n      }\n\n    }else{\n      recorder.stop(); \n    }\n    setRecording(!recording);\n    \n  };\n\n\n  return (\n    <div className=\"App\">\n      <div className=\"App-header\">React Drum Machine</div>\n      <div id=\"drum-machine\">\n        <div id=\"drumpad-container\">\n          {drumObj.drums.map((drum) => <Drumpad key={drum.id} drum={drum} drumObj={drumObj} handlePlaySound={handlePlaySound} displayHandler={setDisplay} volume={volume}/>)}\n        </div>\n        <div id=\"display-control-container\">\n          <Display \n            value={display} \n            volume={volume} \n            rec={recording} \n            records={records} \n            track={track} />\n          <Controls \n            value={display} \n            volume={volume} \n            rec={recording} \n            records={records}\n            setRecords={setRecords} \n            track={track}\n            trackPlaying={trackPlaying}\n            setTrackPlaying={setTrackPlaying} \n            setTrack={setTrack}\n\n            play={handlePause} \n            handleRecorder={handleRecorder} \n            handleChange={handleVolumeControl}/>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}